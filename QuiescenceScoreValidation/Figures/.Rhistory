setwd("~/Documents/Dormancy_PhD_project_data/RNA_seq_data/GSE93991")
##############
#GSE93991
expr.data <- read.table(file = "GSE93991_RNA-seq_Expression_Data.txt", sep = "\t", header = FALSE)
rownames(expr.data) <- expr.data$V1
expr.data$V1 <- NULL
#Expression data starts from V10
expr.data$V2 <- NULL
expr.data$V3 <- NULL
expr.data$V4 <- NULL
expr.data$V5 <- NULL
expr.data$V6 <- NULL
expr.data$V7 <- NULL
expr.data$V8 <- NULL
expr.data$V9 <- NULL
#Add colnames:
Sample <- c("Quiescence1", "Quiescence2", "Quiescence3", "Proliferation1", "Quiescence4", "Proliferation2", "Quiescence5", "Proliferation3","Proliferation4", "Proliferation5", "Proliferation6", "proliferation7", "Proliferation8", "Proliferation9", "Quiescence6" )
colnames(expr.data) <- Sample
X <- as.matrix(expr.data)
#Load quiescence genes:
setwd("~/Documents/GitHub/CancerDormancy/Data/DormancyGeneList")
load("downregulated_common.RData")
load("downregulated_common_ENSG.RData")
load("upregulated_common.RData")
load("upregulated_common_ENSG.RData")
gene_lists <- list(upregulated_common_ENSG, downregulated_common_ENSG)
es.dif <- gsva(X, gene_lists, method = "zscore", verbose = FALSE, parallel.sz=1)
es.dif <- t(es.dif)
es.dif <- data.frame(es.dif)
es.dif$GSVA_score <- es.dif$X1 - es.dif$X2
#Now look at the differences in scores across the two cell types
binary_groups <- c(1,1,1,0,1,0,1,0,0,0,0,0,0,0,1)
z_score <- es.dif$GSVA_score
z_score_common <- data.frame(z_score, binary_groups)
rownames(z_score_common) <- Sample
setwd("~/Documents/GitHub/CancerDormancy/QuiescenceScoreValidation/Results/")
save(z_score_common, file = "GSE93991_QS.RData")
#Load required packages:
library(GSVA)
library(dplyr)
library(ggplot2)
library(plotROC)
library(RColorBrewer)
gene_lists <- list(upregulated_common_ENSG, downregulated_common_ENSG)
es.dif <- gsva(X, gene_lists, method = "zscore", verbose = FALSE, parallel.sz=1)
es.dif <- t(es.dif)
es.dif <- data.frame(es.dif)
es.dif$GSVA_score <- es.dif$X1 - es.dif$X2
#Now look at the differences in scores across the two cell types
binary_groups <- c(1,1,1,0,1,0,1,0,0,0,0,0,0,0,1)
z_score <- es.dif$GSVA_score
z_score_common <- data.frame(z_score, binary_groups)
rownames(z_score_common) <- Sample
setwd("~/Documents/GitHub/CancerDormancy/QuiescenceScoreValidation/Results/")
save(z_score_common, file = "GSE93991_QS.RData")
#################################################################################
#########ROC curve using quiescence scores for all validation datasets
#################################################################################
##########################################################################
#Load and combine z-score and binary group information for all 7 studies:
setwd("~/Documents/GitHub/CancerDormancy/QuiescenceScoreValidation/Results/")
#GSE152699
load("GSE152699_QS.RData")
GSE152699 <- z_score_common
rm(z_score_common)
GSE152699$"Combined z-score" <- GSE152699$z_score
GSE152699$z_score <- NULL
GSE152699$Dataset <- "GSE152699"
#GSE131594
load("GSE131594_QS.RData")
GSE131594 <- z_score_common
rm(z_score_common)
GSE131594$"Combined z-score" <- GSE131594$z_score
GSE131594$z_score <- NULL
GSE131594$Dataset <- "GSE131594"
#GSE83142
load("GSE83142_QS.RData")
GSE83142 <- z_scores
rm(z_scores)
GSE83142$"Combined z-score" <- GSE83142$Combined_z_score
GSE83142$Combined_z_score <- NULL
GSE83142$Dataset <- "GSE83142"
GSE83142$binary_groups <- GSE83142$binary_group
GSE83142$binary_group <- NULL
#GSE75367
load("GSE75367_QS.RData")
GSE75367 <- z_scores
rm(z_scores)
GSE75367$"Combined z-score" <- GSE75367$z_scores
GSE75367$z_scores <- NULL
GSE75367$Dataset <- "GSE75367"
GSE75367$binary_groups <- GSE75367$binary_group
GSE75367$binary_group <- NULL
#GSE137912
load("GSE137912_QS.RData")
GSE137912 <- z_scores
rm(z_scores)
GSE137912$"Combined z-score" <- GSE137912$Score
GSE137912$Score <- NULL
GSE137912$Dataset <- "GSE137912"
GSE137912$binary_groups <- GSE137912$binary_group
GSE137912$binary_group <- NULL
#GSE93991
load("GSE93991_QS.RData")
GSE93991 <- z_score_common
rm(z_score_common)
GSE93991$"Combined z-score" <- GSE93991$z_score
GSE93991$z_score <- NULL
GSE93991$Dataset <- "GSE93991"
#GSE114012
load("GSE114012_QS.RData")
GSE114012 <- z_scores
rm(z_scores)
GSE114012$"Combined z-score" <- GSE114012$z_score
GSE114012$z_score <- NULL
GSE114012$Dataset <- "GSE114012"
GSE114012$binary_groups <- GSE114012$binary_group
GSE114012$binary_group <- NULL
#####################################
#Merge the scores for the 5 datasets:
#####################################
GSE114012 <- GSE114012[,order(colnames(GSE114012))]
GSE131594 <- GSE131594[,order(colnames(GSE131594))]
GSE137912 <- GSE137912[,order(colnames(GSE137912))]
GSE152699 <- GSE152699[,order(colnames(GSE152699))]
GSE75367 <- GSE75367[,order(colnames(GSE75367))]
GSE83142 <- GSE83142[,order(colnames(GSE83142))]
GSE93991 <- GSE93991[,order(colnames(GSE93991))]
merged_data <- rbind(GSE114012,GSE131594,GSE137912,GSE152699,GSE75367,GSE83142,GSE93991)
myCol <- brewer.pal(7, "Spectral")
setwd("~/Documents/GitHub/CancerDormancy/QuiescenceScoreValidation/Figures/")
basicplot <- ggplot(merged_data, aes(d = binary_groups, m = `Combined z-score`, color = Dataset)) + geom_roc(n.cuts = 10, labels = FALSE) + annotate("text", x = .8, y = .14,
label = "GSE114012 AUC = 0.766\nGSE131594 AUC = 0.965\nGSE137912 AUC = 0.986\nGSE152699 AUC = 1.000\nGSE75367 AUC = 0.928\nGSE83142 AUC = 0.922\nGSE93991 AUC = 0.778")
pdf("QuiescenceScoreValidation_ROC.pdf",height = 5, width = 7)
basicplot + labs(x = "False positive fraction", y = "True positive fraction") + theme_classic() +
theme(axis.text.x = element_text(color = "grey20",face = "plain",size = 12,family = "sans"),
axis.text.y = element_text(color = "grey20",face = "plain",size = 12,family = "sans"),
axis.title.x = element_text(color = "grey20",face = "plain",size = 12,family = "sans"),
axis.title.y = element_text(color = "grey20", face = "plain",size = 12,family = "sans"),
legend.text = element_text(colour = "grey20",face = "plain",size = 12,family = "sans")) + scale_color_manual(values = myCol)
dev.off()
#AUC calculations
AUC <- data.frame(calc_auc(basicplot))
AUC
